<!DOCTYPE html><html lang="Chinese"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 我终于有资格吐槽PHP了！ · 萝莉背剑闯江湖</title><meta name="description" content="我终于有资格吐槽PHP了！ - 黄某崽"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://orzzai.github.io/atom.xml" title="萝莉背剑闯江湖"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"><h1>萝莉背剑闯江湖</h1></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/about/" target="_self" class="nav-list-link">ABOUT</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="/subscribe/" target="_self" class="nav-list-link">SUBSCRIBE</a></li></ul></header><h5 style="color:#7f8c8d">一只过期萝莉的碎碎念</h5><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">我终于有资格吐槽PHP了！</h1><div class="post-info">Aug 3, 2020</div><div class="post-content"><p>终于算是写出了我的第一个Wordpress主题，于是我觉得我终于有资格评价一下长期被群嘲（？）的php了。</p>
<p>总结：对于没怎么编过程的人而言应该非常贴合直觉，但对于敲了一年以上代码的人来讲……真的非常反直觉！</p>
<p>毕竟我自己的经验和眼界也是有局限性的，直接下结论说“这不是一个好的编程语言”未免偏颇武断。不过就我写过的这几十行Wordpress代码看来，php的思路违反了很多我上学和工作中学到并认同的coding best practices，这里做个总结。当然我总结的wordpress编程思路可能并不是php的锅而只是wordpress设计的锅，我现在就先当他们是一回事吧😂</p>
<h4 id="在用户不知情的情况下悄摸摸改变全局变量"><a href="#在用户不知情的情况下悄摸摸改变全局变量" class="headerlink" title="在用户不知情的情况下悄摸摸改变全局变量"></a>在用户不知情的情况下悄摸摸改变全局变量</h4><p>这个我觉得真的不能忍——我上Computer Organization（讲CPU啊内存什么的）的时候学了点简单汇编，那会儿教授强调过“目标程序所占据的存储位置是在汇编时固定的，并且以后不能改变”——导致我把这个思路延伸到所有程序里面，认为除了函数名为动词的setter（比如set/increment/handleListener/addListener/removeListener）以外，其他任何函数都不应该改变程序里面已经被定义的变量。</p>
<p>那么假如我给一个博客写主页，后端返回了我10篇文章，我大概会把每篇文章看作一个object，有自己的结构什么的，然后以这种逻辑显示到主页上——</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">var post;  // 注意我清楚明白的定义了post这个变量！</span><br><span class="line">while posts.have_next() &#123;</span><br><span class="line">	post = posts-&gt;next();</span><br><span class="line">	echo &apos;&lt;h1&gt;&apos; + post-&gt;get_the_title() + &apos;&lt;/h1&gt;&apos;;</span><br><span class="line">	echo &apos;&lt;p&gt;&apos; + post-&gt;get_the_excerpt() + &apos;&lt;/p&gt;&apos;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>而Wordpress是这么个逻辑……</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">while ( have_posts() ) &#123;</span><br><span class="line">	the_post();</span><br><span class="line">	echo &apos;&lt;h1&gt;&apos; + get_the_title() + &apos;&lt;/h1&gt;&apos;;</span><br><span class="line">	echo &apos;&lt;p&gt;&apos; + get_the_excerpt() + &apos;&lt;/p&gt;&apos;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我第一眼看到这样代码的时候我就特别纳闷，<code>get_the_title()</code>和<code>get_the_excerpt()</code>是怎么知道应该读取哪一篇post的信息的呢……后来我发现了——<code>the_post()</code>这个我看着像是个getter的玩意儿，悄摸摸的设了个全局变量，然后<code>get_the_title()</code>等等也是悄摸摸的从这个全局变量里面拿信息（然后尼玛还把一个叫<code>$title</code>的全局变量改了！不能忍）。</p>
<p><img src="/images/wp_the_post.png" alt="the_post"></p>
<p>在思考后我觉得我能够说出为什么代码这样写不好——很难查异常，很难维护，而且全局变量很容易被overwrite，等等。但我的下意识的反应却并没有这些，只是觉得——怎么那么反直觉，我只有在上学的时候才写过这种逻辑不明的代码啊！</p>
<h4 id="函数名无法反映函数在干嘛"><a href="#函数名无法反映函数在干嘛" class="headerlink" title="函数名无法反映函数在干嘛"></a>函数名无法反映函数在干嘛</h4><p>这个，在我翻了一些php教程以后，觉得大概率还是wordpress的锅而不是php的，不过还是吐槽一下。</p>
<p>setter/getter闹不清楚。上面已经写了, <code>the_post()</code>这个让我觉得大概应该是个get函数的玩意儿，事实上改变了一个全局变量还没返回。这里再举个例子——</p>
<p>我上面写了<code>echo &#39;&lt;h1&gt;&#39; + get_the_title() + &#39;&lt;/h1&gt;&#39;;</code>，事实上我用的模版直接是这么写的：<code>the_title(&#39;&lt;h1&gt;&#39;, &#39;&lt;/h1&gt;&#39;)</code>。</p>
<p>把tag name作为参数传进去这个我觉得没问题，要命的是<code>the_title</code>给我的感觉，和<code>get_the_title</code>是没什么区别的呀。结果<code>the_title</code>做了以下两个让我难以理解的事情——</p>
<ol>
<li>改变<code>$title</code>这个全局变量的值</li>
<li><code>echo get_the_title(&#39;&lt;h1&gt;&#39;, &#39;&lt;/h1&gt;&#39;)</code></li>
</ol>
<p>后来我看了源代码以后发现其实是这样的——<code>function the_title( $before = &#39;&#39;, $after = &#39;&#39;, $echo = true )</code></p>
<p>所以说其实<code>echo</code>是否执行，取决于是否第三个参数有被设置为<code>false</code>。如果这个参数被设为false它就是个get function，被设为true或者没被设，它就直接把这个值<code>echo</code>到html页面里……</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">if ( $echo ) &#123;</span><br><span class="line">    echo $title;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    return $title;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>反正我敢说，要是我上班的时候提交这样奇特的代码，肯定过不了code review…</p>
<hr>
<p>虽说这些代码的思路让我觉得瞠目结舌，但是又有点难以名状的熟悉感。后来我明白了，我上班前写的代码和这个贼像——不考虑模块化，不考虑可读性可维护性，靠那个时候的直觉写出来的代码真的长这样。我想这也是为什么大家都说“php很容易上手“吧。</p>
<p>下面这是我CS 111的作业……那会儿我还没学数据结构。我居然还能找到这样的历史资料，不愧是我啊哈哈哈哈哈</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">&quot;&quot;&quot;</span><br><span class="line">GINNY HUANG (I don&apos;t wanna be taken off points b/c this again!)</span><br><span class="line">CS111</span><br><span class="line">Problem Set 3: Complete the appropriate function definitions</span><br><span class="line">See prog3.pdf link on the course schedule.</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">import random</span><br><span class="line"></span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">Describe the function here:</span><br><span class="line">1.The user inputs the range.</span><br><span class="line">2.count=0</span><br><span class="line">3.guess u=(l+h)/2</span><br><span class="line">4.if user say high, then u=(u+l)//2;if user say low, then u=(u+h)//2.</span><br><span class="line">5.count += 1</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">def guess():</span><br><span class="line">    print(&apos;Hello. In this guessing game I will guess a number you have selected.&apos;)</span><br><span class="line">    l,h=input(&apos;What is the range from which you will select (low hi):&apos;).split(&apos; &apos;)</span><br><span class="line">    l=int(l)</span><br><span class="line">    h=int(h)</span><br><span class="line">    count = 0</span><br><span class="line">    u = (1+h)//2</span><br><span class="line"></span><br><span class="line">    g=input(&apos;Is it &apos; + str(u) + &apos;[y/n]?&apos;)</span><br><span class="line">    while g == &apos;n&apos;:</span><br><span class="line">        s = input(&apos;Was &apos; + str(u) + &apos; hi or lo?&apos;)</span><br><span class="line">        if s == &apos;hi&apos;:</span><br><span class="line">            h = u - 1</span><br><span class="line">        else:</span><br><span class="line">            l = u + 1</span><br><span class="line">        u = (l+h)//2</span><br><span class="line">        count += 1</span><br><span class="line">        g = input(&apos;Is it &apos; + str(u) + &apos;[y/n]?&apos;)</span><br><span class="line">    count += 1</span><br><span class="line">    print(&apos;Yea!!! I guessed it in &apos; + str(count) + &apos; tries!\nThanks for the fun.&apos;)</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">Describe the function here: Suppose the number is 100.</span><br><span class="line">...</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">def dec2oct():</span><br><span class="line">    ... # 略了，和上面那个差不多</span><br><span class="line"></span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">main: This is the main function, where the user is repeatedly asked which of the</span><br><span class="line">above programs to execute. When the user enters an invalid choice, the program</span><br><span class="line">will quit.</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">def main():</span><br><span class="line">    while True:</span><br><span class="line">        choice = input(&quot;Please choose from &apos;guess&apos;, or &apos;dec2oct&apos;\n&quot; \</span><br><span class="line">                       + &quot;to run the appropriate program (nothing to quit): &quot;)</span><br><span class="line">        if len(choice) == 0 or choice not in [&apos;guess&apos;, &apos;dec2oct&apos;]:</span><br><span class="line">            break</span><br><span class="line"></span><br><span class="line">        eval(choice + &quot;()&quot;)</span><br><span class="line">        print()</span><br><span class="line">    print(&quot;Thank you.\n&quot;)</span><br><span class="line"></span><br><span class="line">main()</span><br></pre></td></tr></table></figure>
<p>（等等，为什么那个时候我会用eval…一定是叫兽教我的！）</p>
<h3 id="番外：其实我还想吐槽MailChimp来着"><a href="#番外：其实我还想吐槽MailChimp来着" class="headerlink" title="番外：其实我还想吐槽MailChimp来着"></a>番外：其实我还想吐槽MailChimp来着</h3><p>有朋友表示希望能用邮件订阅这个博客，感到莫大荣幸的我决定去研究一下subscription的实现。网上随便搜索了一下，看到最多的词是Jetpack和MailChimp，然后很多人表示“后来我不用Jetpack而转投MailChimp了”加上我很久之前实习的公司也用MailChimp来着，于是就决定试一下。</p>
<p>然而我天真的以为MailChimp就是个简单的plugin，用<code>npm install</code>就能搞定的那种……事实证明我又太天真了！这个服务很全套很复杂而且基本不太需要动代码的啊……能感觉到对于运营人员这玩意儿真的非常好用，然而对我而言就很复杂了😭</p>
<p>首先，我到现在也没找到有什么合适的方法可以在不多交钱的情况下，用一个账号管理三个博客（还好我目前还没有三个博客，但以后就难说了）。我知道通过隐藏tag可以搞清楚“用户是从我哪个博客订阅的”，但是万一有谁同时订阅了我两个博客，我就找不到方法自动去给这样人归类了……</p>
<p>其次，本来我希望得到的效果是“点击一个按钮，跳出一个弹窗可以让用户进行订阅”的，结果Subscriber pop-up只支持“第一次打开主页就直接打开弹窗让用户订阅”。我通过改代码倒是实现了“通过点击按钮打开弹窗”的功能，可是还是绕不过“第一次打开主页”这个限制（也就是用户只有清空缓存后第一次点那个按钮，才会跳出弹窗让人订阅，第二次点就不行了）。发现这点后我也懒得和它磨了，最后还是只能靠Embedded forms从头做了个订阅功能（如果我有那个闲工夫的话应该还是可以做成弹窗，不过……好吧，还是懒😂）</p>
<p>在推上吐槽了两句MailChimp以后有老司机来推荐mailgun，看来下回我应该试试这个……</p>
</div></article></div></main><footer><div class="paginator"><a href="/2020/07/04/women-products/" class="pag-button next">Next</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'orzzai';
var disqus_identifier = '2020/08/03/php-sucks/';
var disqus_title = '我终于有资格吐槽PHP了！';
var disqus_url = 'http://orzzai.github.io/2020/08/03/php-sucks/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//orzzai.disqus.com/count.js" async></script><div class="copyright"><p>© 2015 - 2020 <a href="http://orzzai.github.io">黄某崽</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>